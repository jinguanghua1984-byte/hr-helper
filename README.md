# HR Helper - Chrome 扩展

一个强大的 Chrome 扩展，专为 HR 和招聘人员设计，支持在 BOSS 直聘 (zhipin.com) 和脉脉 (maimai.cn) 上自动加载全部职位数据，并采集候选人信息导出为 Excel。

## 功能特性

### 1. 自动加载全部职位
支持多种加载模式，适配不同平台的数据加载机制：

**BOSS 直聘 (滚动加载)**
- 自动滚动到底部触发数据加载
- 实时显示已加载的职位数量
- 智能检测加载完成状态
- 加载完成后显示桌面通知

**脉脉 (点击加载)**
- 自动点击"加载更多"按钮
- 支持多种按钮文本识别（"加载更多"、"更多"、"换一批"）
- 同样支持实时进度显示和完成通知

### 2. 候选人数据采集
一键采集页面上的候选人详细信息：

**BOSS 直聘采集字段**
- 基本信息：姓名、活跃度、年龄、学历、工作年限
- 求职意向：当前状态、期望职位、薪资期望
- 工作经历：最近公司、完整工作经历（时间线）
- 教育经历：毕业院校、完整教育背景
- 技术优势：技术栈与核心优势

**脉脉采集字段**
- 基本信息：姓名、性别、年龄、城市、学历
- 职业信息：活跃度、工作年限、现任职位
- 其他信息：标签、就职公司、毕业院校

### 3. 数据展示与管理
- **分页浏览**：每页显示 10 条候选人数据
- **详情面板**：点击查看候选人完整信息
- **时间线展示**：工作和教育经历以时间线形式清晰呈现

### 4. 数据导出
- **CSV 格式**：导出为 Excel 兼容的 CSV 文件
- **自动编码**：添加 BOM 头确保中文正确显示
- **自动下载**：采集完成后自动触发下载

## 安装步骤

### 1. 加载扩展到 Chrome

1. 打开 Chrome 浏览器
2. 在地址栏输入 `chrome://extensions/`
3. 开启右上角的「开发者模式」
4. 点击「加载已解压的扩展程序」
5. 选择 `hr-helper` 文件夹

### 2. 验证安装
- 在浏览器工具栏看到 H 图标
- 点击图标弹出扩展界面

## 使用方法

### 自动加载全部职位

#### BOSS 直聘
1. 访问 BOSS 直聘搜索页面（例如：https://www.zhipin.com/web/geek/job?...）
2. 点击浏览器工具栏中的 H 图标
3. 确认「状态」显示为「准备就绪」
4. 点击「加载全部职位」按钮
5. 等待自动滚动加载完成
6. 加载完成后会收到通知显示加载数量

#### 脉脉
1. 访问脉脉候选人列表页面
2. 点击浏览器工具栏中的 H 图标
3. 点击「加载全部职位」按钮
4. 等待自动点击加载完成
5. 查看加载进度和最终数量

### 采集候选人数据

1. **先完成职位加载**（使用上述功能加载全部数据）
2. 点击「采集人选数据」按钮
3. 等待采集完成
4. **自动导出**：CSV 文件会自动下载
5. **查看数据**：在扩展窗口中浏览采集到的候选人信息

#### 浏览候选人数据
- 使用「上一页」/「下一页」按钮翻页
- 点击任意候选人查看详细信息
- 详情面板从右侧滑出，显示完整信息

## 文件结构

```
hr-helper/
├── manifest.json       # 扩展配置文件（Manifest V3）
├── popup.html          # 弹窗界面
├── popup.js            # 弹窗逻辑（UI 控制、数据展示、导出）
├── content.js          # 注入到网页的脚本（加载逻辑、数据提取）
├── icons/              # 图标文件夹
│   ├── icon16.png      # 16x16 图标
│   ├── icon48.png      # 48x48 图标
│   └── icon128.png     # 128x128 图标
├── create_icons.py     # 图标生成脚本
├── convert_icons.py    # 图标格式转换脚本
├── README.md           # 说明文件
├── CLAUDE.md           # Claude Code 开发指南
└── TROUBLESHOOTING.md  # 问题排查记录
```

## 技术架构

### 多平台配置系统

扩展采用配置化的方式支持多个平台，每个平台有独立的配置：

```javascript
SITE_CONFIGS = {
  zhipin: {
    CANDIDATE_SELECTOR: '.card-item',
    LOAD_TYPE: 'scroll',      // 滚动加载
    WAIT_TIME: 2500,
    extractData: 'extractZhipinData'
  },
  maimai: {
    CANDIDATE_SELECTOR: '.card___3gwOI',
    LOAD_TYPE: 'button',      // 点击按钮加载
    LOAD_MORE_SELECTOR: '[class*="load-more"]',
    extractData: 'extractMaimaiData'
  }
}
```

### 加载流程

**滚动模式 (BOSS 直聘)**
1. 循环执行（最多 100 次）
2. 滚动到页面底部
3. 等待 2.5 秒让数据加载
4. 统计当前职位数量
5. 检测"没有更多"提示
6. 检测数量是否增加（连续 3 次未增加则停止）

**点击模式 (脉脉)**
1. 循环执行（最多 100 次）
2. 查找"加载更多"按钮
3. 点击按钮
4. 等待 2.5 秒让数据加载
5. 统计当前职位数量
6. 检测"没有更多"提示
7. 检测数量是否增加

### 数据提取流程

1. 遍历所有候选人卡片
2. 根据 CSS 选择器提取各字段信息
3. 处理特殊情况（如多值字段、时间线格式）
4. 返回结构化数据
5. 发送到 popup 界面展示
6. 自动导出为 CSV

### Chrome 扩展技术要点

**Manifest V3**
- 使用最新的 Manifest V3 规范
- 权限：`activeTab`, `notifications`, `downloads`
- 主机权限：`https://www.zhipin.com/*`, `https://maimai.cn/*`

**CSP (内容安全策略) 限制**
- 不使用外部 CDN 脚本
- 所有事件监听使用 `addEventListener`
- CSV 导出使用原生 JavaScript 实现

## 开发调试

### 修改代码后重新加载
在 `chrome://extensions/` 页面点击扩展卡片下方的刷新按钮即可。

### 调试工具

**内容脚本调试**（在招聘网站页面按 F12）
```javascript
// 查找候选人卡片选择器
debugHRHelper()

// 调试"当前状态"提取（BOSS 直聘）
debugJobStatus()

// 查看当前站点配置
debugSiteConfig()

// 测试脉脉数据提取
debugMaimaiExtract([index])
```

**弹窗脚本调试**
- 右键点击扩展工具栏图标
- 选择「检查」
- 在弹出的 DevTools 中查看 `popup.js` 日志

### 常见问题

**问题 1：选择器失效**
- 症状：无法加载职位或采集数据
- 解决：使用 `debugHRHelper()` 查找新的选择器，更新 `content.js`

**问题 2：数据提取不完整**
- 症状：某些字段显示为空
- 解决：使用浏览器 DevTools 检查 DOM 结构，更新选择器

**问题 3：CSV 中文乱码**
- 症状：导出的 CSV 文件中文显示不正常
- 解决：确保文件包含 BOM 头 (`\uFEFF`)，使用 Excel 打开

更多问题排查请参考 [TROUBLESHOOTING.md](TROUBLESHOOTING.md)

## 版本历史

### v3.0.0 (2026-02-04)
- 添加脉脉 (maimai.cn) 平台支持
- 实现候选人数据采集功能
- 添加数据分页展示和详情面板
- 实现 CSV 导出功能
- 支持多种加载模式（滚动/点击）
- 优化数据提取和格式化

### v2.0.0
- 添加全部加载职位功能
- 限制域名到 zhipin.com

### v1.0.0
- 初始版本，仅支持背景色修改（已移除）

## 支持的平台

- ✅ BOSS 直聘 (https://www.zhipin.com)
- ✅ 脉脉 (https://maimai.cn)

## 注意事项

1. **使用前请先加载职位**：采集数据前务必先使用"加载全部职位"功能
2. **网络稳定**：加载过程中请保持网络稳定
3. **不要关闭弹窗**：加载和采集过程中请勿关闭扩展弹窗
4. **数据准确性**：如网站改版导致选择器失效，需要更新代码
5. **合理使用**：请遵守相关网站的使用条款，合理使用扩展功能

## 许可证

本项目仅供个人学习和研究使用。

## 相关文档

- [CLAUDE.md](CLAUDE.md) - Claude Code 开发指南
- [TROUBLESHOOTING.md](TROUBLESHOOTING.md) - 问题排查记录

---

如有问题或建议，欢迎反馈！
